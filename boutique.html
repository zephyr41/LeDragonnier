<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrousel Couteaux - Le Dragonnier (WordPress Ready)</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
<style>
/* VARIABLES ET RESET DANS L'ENCAPSULATION */
.dragonnierCarousel {
  --primary-red: #9D0208;
  --secondary-orange: #FAA307;
  --accent-orange: #E85D04;
  --dark-text: #121212;
  --light-bg: #F5F5F3;
  --font-family: 'Crimson Text', serif;
  --transition-smooth: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --overlay-black: rgba(18, 18, 18, 0.65);
  --space-sm: 2rem;
}

.dragonnierCarousel * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* TITRE DE SECTION */
.dragonnierCarousel .carousel-section-title {
  padding: 60px 0 40px 0;
  background: var(--light-bg);
  text-align: center;
}

.dragonnierCarousel .carousel-section-title h1 {
  font-family: var(--font-family);
  color: var(--primary-red);
  font-size: clamp(2.5rem, 4vw, 3.5rem);
  margin: 0 0 var(--space-sm) 0;
  font-weight: 400;
  letter-spacing: 2px;
  position: relative;
  cursor: default;
  transition: var(--transition-smooth);
  text-align: center;
}

.dragonnierCarousel .carousel-section-title h1::after {
  content: '';
  position: absolute;
  bottom: -20px;
  left: 50%;
  transform: translateX(-50%);
  width: 100px;
  height: 3px;
  background: linear-gradient(90deg, var(--secondary-orange) 0%, var(--accent-orange) 100%);
  transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.4s;
}

/* CONTAINER PRINCIPAL */
.dragonnierCarousel .knives-carousel {
  position: relative;
  width: 100%;
  height: calc(100svh - var(--wp-admin--admin-bar--height, 0px));
  min-height: calc(100dvh - var(--wp-admin--admin-bar--height, 0px));
  margin: 0;
  overflow: hidden;
  background: var(--dark-text);
  font-family: var(--font-family);
  z-index: 0;
}

/* NEUTRALISATION STYLES WORDPRESS */
.dragonnierCarousel button {
  appearance: none;
  background: none;
  border: none;
  outline: none;
  text-decoration: none;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  color: inherit;
  cursor: pointer;
}

.dragonnierCarousel img {
  display: block;
  max-width: none !important;
  width: 100%;
  height: 100%;
  object-fit: cover;
  border: none;
  box-shadow: none;
  border-radius: 0;
}

/* SLIDES */
.dragonnierCarousel .carousel-slides {
  display: flex;
  transition: transform 0.8s cubic-bezier(0.65, 0, 0.35, 1);
  width: 400%; /* 4 slides = 400% */
  height: 100%;
}

.dragonnierCarousel .carousel-slide {
  width: 25%; /* 100% / 4 slides */
  height: 100%;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

/* MÉDIA AVEC EFFET KEN BURNS */
.dragonnierCarousel .slide-media {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 0;
}

.dragonnierCarousel .slide-bg-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  transform: scale(1.15);
  transition: transform 12s ease-out;
}

.dragonnierCarousel .carousel-slide:first-child .slide-bg-image {
  loading: eager;
  fetchpriority: high;
}

.dragonnierCarousel .carousel-slide.active .slide-bg-image {
  transform: scale(1) translateY(-2%);
}

/* OVERLAY */
.dragonnierCarousel .slide-overlay {
  position: absolute;
  inset: 0;
  background: var(--overlay-black);
  z-index: 1;
}

/* CONTENU DU SLIDE */
.dragonnierCarousel .slide-content {
  position: relative;
  z-index: 2;
  text-align: left;
  max-width: 650px;
  padding: 0 60px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 15px;
  margin-left: 100px;
}

/* ANIMATIONS */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.dragonnierCarousel .carousel-slide.active .slide-content > * {
  animation: fadeInUp 0.6s ease-out forwards;
  opacity: 0;
}

.dragonnierCarousel .carousel-slide.active .slide-title {
  animation-delay: 0.1s;
}

.dragonnierCarousel .carousel-slide.active .slide-subtitle {
  animation-delay: 0.2s;
}

.dragonnierCarousel .carousel-slide.active .slide-btn {
  animation-delay: 0.3s;
}

.dragonnierCarousel .carousel-slide.active .slide-description {
  animation-delay: 0.4s;
}

/* TYPOGRAPHIE */
.dragonnierCarousel .slide-title {
  font-family: var(--font-family) !important;
  font-size: clamp(3.5rem, 6vw, 5rem) !important;
  color: white !important;
  margin: 0 !important;
  font-weight: 400 !important;
  letter-spacing: 2px;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
  line-height: 0.9 !important;
  text-decoration: none !important;
}

.dragonnierCarousel .slide-subtitle {
  font-family: var(--font-family) !important;
  color: var(--secondary-orange) !important;
  font-size: clamp(1rem, 1.8vw, 1.3rem) !important;
  font-weight: 400 !important;
  margin: -5px 0 15px 0 !important;
  text-transform: uppercase;
  letter-spacing: 3px;
  opacity: 0.9;
  text-decoration: none !important;
}

/* PRIX */
.dragonnierCarousel .slide-price {
  font-family: var(--font-family) !important;
  color: var(--secondary-orange) !important;
  font-size: clamp(2rem, 3.5vw, 2.8rem) !important;
  font-weight: 600 !important;
  margin: 5px 0 25px 0 !important;
  letter-spacing: 1px;
  text-shadow: 0 3px 12px rgba(250, 163, 7, 0.4);
  position: relative;
  display: inline-block;
}

.dragonnierCarousel .slide-price::before {
  content: '€';
  font-size: 0.75em;
  margin-right: 6px;
  opacity: 0.9;
  font-weight: 500;
}

.dragonnierCarousel .slide-price::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, var(--secondary-orange), var(--accent-orange));
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.6s ease;
}

.dragonnierCarousel .carousel-slide.active .slide-price::after {
  transform: scaleX(1);
  animation-delay: 0.25s;
}

/* BOUTONS */
.dragonnierCarousel .slide-btn {
  background: linear-gradient(135deg, var(--primary-red), #7A0106) !important;
  color: white !important;
  padding: 18px 40px !important;
  font-family: var(--font-family) !important;
  font-size: 14px !important;
  font-weight: 500 !important;
  text-transform: uppercase;
  letter-spacing: 2px;
  cursor: pointer;
  border-radius: 50px !important;
  transition: all 0.3s ease !important;
  border: none !important;
  text-decoration: none !important;
  display: inline-block;
  margin: 10px 0 20px 0 !important;
  box-shadow: 0 4px 15px rgba(157, 2, 8, 0.3) !important;
  position: relative;
  overflow: hidden;
  outline: none !important;
  appearance: none !important;
}

.dragonnierCarousel .slide-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  transition: left 0.6s ease;
}

.dragonnierCarousel .slide-btn:hover {
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 25px rgba(157, 2, 8, 0.4) !important;
  background: linear-gradient(135deg, #B8020A, var(--primary-red)) !important;
  text-decoration: none !important;
}

.dragonnierCarousel .slide-btn:hover::before {
  left: 100%;
}

/* DESCRIPTION */
.dragonnierCarousel .slide-description {
  font-size: clamp(1rem, 1.4vw, 1.1rem) !important;
  line-height: 1.8 !important;
  color: rgba(255, 255, 255, 0.85) !important;
  margin: 0 !important;
  max-width: 500px;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  font-family: var(--font-family) !important;
}

/* NAVIGATION */
.dragonnierCarousel .carousel-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255, 255, 255, 0.08) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  color: white !important;
  width: 50px !important;
  height: 50px !important;
  border-radius: 50% !important;
  cursor: pointer;
  transition: all 0.3s ease !important;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(10px);
  opacity: 0.6;
  appearance: none !important;
  outline: none !important;
  text-decoration: none !important;
}

.dragonnierCarousel .carousel-nav:hover {
  opacity: 1 !important;
  background: rgba(255, 255, 255, 0.12) !important;
  border-color: rgba(255, 255, 255, 0.3) !important;
}

.dragonnierCarousel .carousel-nav::before {
  content: '';
  width: 10px;
  height: 10px;
  border-top: 2px solid white;
  border-right: 2px solid white;
}

.dragonnierCarousel .carousel-prev {
  left: 30px;
}

.dragonnierCarousel .carousel-prev::before {
  transform: rotate(-135deg) translateX(2px);
}

.dragonnierCarousel .carousel-next {
  right: 30px;
}

.dragonnierCarousel .carousel-next::before {
  transform: rotate(45deg) translateX(-2px);
}

/* PAGINATION */
.dragonnierCarousel .carousel-pagination {
  position: absolute;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 12px;
  z-index: 3;
}

.dragonnierCarousel .pagination-dot {
  width: 10px !important;
  height: 10px !important;
  border-radius: 50% !important;
  background: rgba(255, 255, 255, 0.3) !important;
  border: none !important;
  cursor: pointer;
  transition: all 0.4s ease !important;
  position: relative;
  appearance: none !important;
  outline: none !important;
}

.dragonnierCarousel .pagination-dot:hover {
  background: rgba(255, 255, 255, 0.5) !important;
}

.dragonnierCarousel .pagination-dot.active {
  background: white !important;
  width: 30px !important;
  border-radius: 15px !important;
}

/* INDICATEUR TACTILE */
.dragonnierCarousel .swipe-hint {
  position: absolute;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  color: rgba(255, 255, 255, 0.5);
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 2px;
  display: none;
  animation: pulse 2s ease infinite;
  font-family: var(--font-family);
}

@keyframes pulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.8; }
}

/* SÉPARATEUR */
.dragonnierCarousel .services-separator {
    height: 1px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(157, 2, 8, 0.2) 25%, 
        rgba(250, 163, 7, 0.4) 50%, 
        rgba(157, 2, 8, 0.2) 75%, 
        transparent 100%);
    position: relative;
}

.dragonnierCarousel .services-separator::before {
    content: '❦';
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--light-bg);
    color: var(--secondary-orange);
    font-size: 1.2rem;
    padding: 0 15px;
}

/* RESPONSIVE MOBILE */
@media (max-width: 768px) {
  .dragonnierCarousel .knives-carousel {
    height: 65vh !important;
    min-height: 65vh !important;
  }

  .dragonnierCarousel .slide-content {
    padding: 0 30px;
    margin-left: 0;
    max-width: 100%;
    gap: 8px;
  }
  
  .dragonnierCarousel .slide-title {
    font-size: 2.2rem !important;
  }

  .dragonnierCarousel .slide-subtitle {
    font-size: 0.9rem !important;
  }

  .dragonnierCarousel .slide-price {
    font-size: 1.6rem !important;
    margin: 0 0 15px 0 !important;
  }
  
  .dragonnierCarousel .slide-description {
    font-size: 0.9rem !important;
    -webkit-line-clamp: 2;
  }
  
  .dragonnierCarousel .carousel-nav {
    display: none;
  }

  .dragonnierCarousel .swipe-hint {
    display: block;
    bottom: 20px;
  }

  .dragonnierCarousel .carousel-pagination {
    bottom: 20px;
  }

  .dragonnierCarousel .slide-btn {
    padding: 14px 30px !important;
    font-size: 12px !important;
    margin: 8px 0 12px 0 !important;
  }
}

/* DESKTOP */
@media (min-width: 1024px) {
  .dragonnierCarousel .slide-bg-image {
    object-position: center 40%;
  }
}
</style>
</head>
<body>
  
<div class="dragonnierCarousel">
  <div class="services-separator"></div>
  <div class="carousel-section-title">
    <h1>Boutique</h1>
  </div>

  <div class="knives-carousel">
    <div class="carousel-slides" id="carouselSlides">
      <!-- Slide 1 Ornak -->
      <div class="carousel-slide active" data-product-id="19093">
        <div class="slide-media">
          <img src="https://images.unsplash.com/photo-1543875929-c09f1e273428?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" 
              alt="Ornak - Couteau de table élégant" 
              class="slide-bg-image"
              loading="lazy"
              decoding="async">
          <div class="slide-overlay"></div>
        </div>
        <div class="slide-content">
          <h2 class="slide-title">Ornak</h2>
          <p class="slide-subtitle">Le couteau de table</p>
          <div class="slide-price"></div>
          <a href="https://ledragonnier.com/index.php/produit/ornak-le-couteau-de-table/" class="slide-btn">Commander Ornak</a>
          <p class="slide-description">
            Ornak est une lame simple en apparence, mais travaillée dans le détail. Conçu pour sublimer l'usage quotidien avec sobriété et noblesse.
          </p>
        </div>
      </div>
        
      <!-- Slide 2: Sylvarak -->
      <div class="carousel-slide" data-product-id="19077">
        <div class="slide-media">
          <img src="https://images.unsplash.com/photo-1640687700961-423c172133e7?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" 
               alt="Sylvarak - Couteau pliant artisanal" 
               class="slide-bg-image"
               loading="eager"
               fetchpriority="high"
               decoding="async">
          <div class="slide-overlay"></div>
        </div>
        <div class="slide-content">
          <h2 class="slide-title">Sylvarak</h2>
          <p class="slide-subtitle">Le couteau pliant</p>
          <div class="slide-price"></div>
          <a href="https://ledragonnier.com/index.php/produit/19077/" class="slide-btn">Commander Sylvarak</a>
          <p class="slide-description">
            Discret et racé, Sylvarak est une lame de poche pensée pour accompagner le quotidien avec élégance. Inspiré des lames nomades et des dagues forestières.
          </p>
        </div>
      </div>

      <!-- Slide 3 Feranak -->
      <div class="carousel-slide" data-product-id="19084">
        <div class="slide-media">
          <img src="https://images.unsplash.com/photo-1602063239056-b531b101065d?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" 
               alt="Feranak - Couteau d'office de précision" 
               class="slide-bg-image"
               loading="lazy"
               decoding="async">
          <div class="slide-overlay"></div>
        </div>
        <div class="slide-content">
          <h2 class="slide-title">Feranak</h2>
          <p class="slide-subtitle">Le couteau d'office</p>
          <div class="slide-price"></div>
          <a href="https://ledragonnier.com/index.php/produit/feranak-le-couteau-doffice/" class="slide-btn">Commander Feranak</a>
          <p class="slide-description">
            Taillé pour la précision, Feranak est la lame du geste juste. Sa prise en main directe et son équilibre millimétré en font un outil redoutable en cuisine.
          </p>
        </div>
      </div>

      <!-- Slide 4: Velkaran -->
      <div class="carousel-slide" data-product-id="19051">
        <div class="slide-media">
          <img src="https://images.pexels.com/photos/952478/pexels-photo-952478.jpeg" 
               alt="Velkaran - Couteau de cuisine professionnel" 
               class="slide-bg-image"
               loading="lazy"
               decoding="async">
          <div class="slide-overlay"></div>
        </div>
        <div class="slide-content">
          <h2 class="slide-title">Velkaran</h2>
          <p class="slide-subtitle">Le couteau de cuisine</p>
          <div class="slide-price"></div>
          <a href="https://ledragonnier.com/index.php/produit/sylvarak-le-couteau-pliant/" class="slide-btn">Commander Velkaran</a>
          <p class="slide-description">
            Modèle le plus imposant de la famille, Velkaran incarne la puissance maîtrisée. Sa lame généreuse en fait un véritable outil de chef.
          </p>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <button class="carousel-nav carousel-prev" onclick="dragonnierCarousel.changeSlide(-1)" aria-label="Slide précédent"></button>
    <button class="carousel-nav carousel-next" onclick="dragonnierCarousel.changeSlide(1)" aria-label="Slide suivant"></button>

    <!-- Pagination -->
    <div class="carousel-pagination">
      <button class="pagination-dot active" onclick="dragonnierCarousel.goToSlide(0)" aria-label="Sylvarak"></button>
      <button class="pagination-dot" onclick="dragonnierCarousel.goToSlide(1)" aria-label="Feranak"></button>
      <button class="pagination-dot" onclick="dragonnierCarousel.goToSlide(2)" aria-label="Ornak"></button>
      <button class="pagination-dot" onclick="dragonnierCarousel.goToSlide(3)" aria-label="Velkaran"></button>
    </div>

    <div class="swipe-hint">← Glissez →</div>
  </div>
</div>

<script>
window.dragonnierCarousel = (function() {
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

  let currentSlide = 0;
  const totalSlides = 4;
  let slidesContainer, dots, slides, carousel;
  let autoPlayInterval;
  let isTransitioning = false;

  function init() {
    slidesContainer = document.getElementById('carouselSlides');
    if (!slidesContainer) return;
    
    dots = document.querySelectorAll('.dragonnierCarousel .pagination-dot');
    slides = document.querySelectorAll('.dragonnierCarousel .carousel-slide');
    carousel = document.querySelector('.dragonnierCarousel .knives-carousel');

    const actualSlides = slides.length;
    if (actualSlides !== totalSlides) {
      slidesContainer.style.width = `${actualSlides * 100}%`;
      slides.forEach(slide => {
        slide.style.width = `${100 / actualSlides}%`;
      });
    }

    updateCarousel();
    startAutoPlay();
    setupEventListeners();
  }

  function updateCarousel() {
    if (isTransitioning || !slidesContainer) return;
    isTransitioning = true;

    const translateX = -currentSlide * (100 / totalSlides);
    slidesContainer.style.transform = `translateX(${translateX}%)`;
    
    slides.forEach((slide, index) => {
      slide.classList.toggle('active', index === currentSlide);
    });
    
    dots.forEach((dot, index) => {
      dot.classList.toggle('active', index === currentSlide);
    });

    setTimeout(() => {
      isTransitioning = false;
    }, 800);
  }

  function changeSlide(direction) {
    currentSlide += direction;
    
    if (currentSlide >= totalSlides) {
      currentSlide = 0;
    } else if (currentSlide < 0) {
      currentSlide = totalSlides - 1;
    }
    
    updateCarousel();
  }

  function goToSlide(slideIndex) {
    if (slideIndex >= 0 && slideIndex < totalSlides) {
      currentSlide = slideIndex;
      updateCarousel();
    }
  }

  function startAutoPlay() {
    stopAutoPlay();
    autoPlayInterval = setInterval(() => {
      changeSlide(1);
    }, 7000);
  }

  function stopAutoPlay() {
    if (autoPlayInterval) {
      clearInterval(autoPlayInterval);
      autoPlayInterval = null;
    }
  }

  function setupEventListeners() {
    if (!carousel) return;

    carousel.addEventListener('mouseenter', stopAutoPlay);
    carousel.addEventListener('mouseleave', startAutoPlay);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        changeSlide(-1);
        stopAutoPlay();
        startAutoPlay();
      } else if (e.key === 'ArrowRight') {
        changeSlide(1);
        stopAutoPlay();
        startAutoPlay();
      }
    });

    let touchStartX = 0;
    let touchEndX = 0;
    let touchStartY = 0;
    let touchEndY = 0;

    carousel.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });

    carousel.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      touchEndY = e.changedTouches[0].screenY;
      
      const swipeThresholdX = 50;
      const swipeThresholdY = 100;
      
      const diffX = touchStartX - touchEndX;
      const diffY = Math.abs(touchStartY - touchEndY);
      
      if (Math.abs(diffX) > swipeThresholdX && diffY < swipeThresholdY) {
        if (diffX > 0) {
          changeSlide(1);
        } else {
          changeSlide(-1);
        }
        stopAutoPlay();
        startAutoPlay();
      }
    }, { passive: true });

    carousel.addEventListener('touchend', () => {
      const hint = carousel.querySelector('.swipe-hint');
      if (hint) {
        hint.style.display = 'none';
      }
    }, { once: true, passive: true });
  }

  return {
    changeSlide: changeSlide,
    goToSlide: goToSlide,
    startAutoPlay: startAutoPlay,
    stopAutoPlay: stopAutoPlay
  };
})();

// SCRIPT PRIX WOOCOMMERCE
(function(){
  function productEndpoint(id){
    var pretty = "/wp-json/wc/store/v1/products/" + id;
    var fallback = "/index.php?rest_route=/wc/store/v1/products/" + id;
    return fetch(pretty).then(function(r){
      if(r.ok) return r;
      return fetch(fallback);
    });
  }

  document.querySelectorAll('.dragonnierCarousel [data-product-id]').forEach(function(card){
    var id = card.getAttribute('data-product-id');
    var priceEl = card.querySelector('.slide-price');
    if(!id || !priceEl) return;

    productEndpoint(id)
      .then(function(res){ return res.json(); })
      .then(function(prod){
        if (prod && prod.price_html) {
          priceEl.innerHTML = prod.price_html;
        } else {
          priceEl.textContent = '—';
        }
      })
      .catch(function(){ priceEl.textContent = '—'; });
  });
})();
</script>

</body>
</html>